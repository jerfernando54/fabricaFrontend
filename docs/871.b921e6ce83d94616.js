"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[871],{6871:(F,p,l)=>{l.r(p),l.d(p,{UserModule:()=>J});var u=l(4755),i=l(5030),d=l(672),g=l(590),f=l(6038),U=l(2032);const C={cilPen:f.C,cilPlus:["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='440 240 272 240 272 72 240 72 240 240 72 240 72 272 240 272 240 440 272 440 272 272 440 272 440 240' class='ci-primary'/>"],cilTrash:U.N,cilUserPlus:["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M208,16A112.127,112.127,0,0,0,96,128v79.681a80.236,80.236,0,0,0,9.768,38.308l27.455,50.333L60.4,343.656A79.725,79.725,0,0,0,24,410.732V496H312V464H56V410.732a47.836,47.836,0,0,1,21.841-40.246l97.66-63.479-41.64-76.341A48.146,48.146,0,0,1,128,207.681V128a80,80,0,0,1,160,0v79.681a48.146,48.146,0,0,1-5.861,22.985L240.5,307.007,312,353.483V315.317l-29.223-19,27.455-50.334A80.23,80.23,0,0,0,320,207.681V128A112.127,112.127,0,0,0,208,16Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='424 400 424 336 392 336 392 400 328 400 328 432 392 432 392 496 424 496 424 432 488 432 488 400 424 400' class='ci-primary'/>"]},b=["Administrador","Fabrica"];var e=l(9523),_=l(9169),h=l(6702),s=l(5209);function A(t,a){if(1&t&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function v(t,a){1&t&&e._UZ(0,"span",43)}function q(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"div"),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"div"),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"div"),e._uU(9),e.qZA()(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"div",44),e._uU(14),e.qZA()(),e.TgZ(15,"td")(16,"div",45)(17,"button",46),e.NdJ("click",function(){const c=e.CHM(o).$implicit,m=e.oxw();return e.KtG(m.confirmarUser(c))}),e.O4$(),e._UZ(18,"svg",47),e.qZA(),e.kcU(),e.TgZ(19,"button",48),e.NdJ("click",function(){const c=e.CHM(o).$implicit,m=e.oxw();return e.KtG(m.confirmarUser(c))}),e.O4$(),e._UZ(20,"svg",47),e.qZA()()()()}if(2&t){const o=a.$implicit,r=e.oxw(),n=e.MAs(27),c=e.MAs(10);e.xp6(3),e.Oqu(o.name),e.xp6(3),e.Oqu(o.username),e.xp6(3),e.hij(" ",o.role," "),e.xp6(2),e.hij(" ",o.email," "),e.xp6(3),e.Oqu(r.getDate(o.createdAt)),e.xp6(3),e.Q6J("cModalToggle",n.id),e.xp6(1),e.Q6J("cIcon",r.icons.cilPen),e.xp6(1),e.s9C("disabled",o.userId==r.currentUserId),e.Q6J("cModalToggle",c.id),e.xp6(1),e.Q6J("cIcon",r.icons.cilTrash)}}const B=[{path:"users",component:(()=>{class t{constructor(o,r,n){this.userSVC=o,this.formBuilder=r,this.router=n,this.user={},this.users=[],this.icons=C,this.roles=b,this.loading=!1,this.submited=!1,this.toast=!0,this.showToast=!1,this.isButtonLoginDisabled=!0,this.showToastBorrarUsuario=!1,this.bgColor="",this.toastTitle="",this.toastContent="",this.currentUserId=""}ngOnInit(){this.getUsers(),this._userSubscription=this.userSVC.refresh$.subscribe(()=>{this.getUsers()}),this.currentUserId=JSON.parse(localStorage.getItem("user")).id,this.createForm(),this.disableInputs()}getUsers(){this.userSVC.getUsers().subscribe(()=>{this.users=JSON.parse(localStorage.getItem("users"))})}getDate(o){return new Date(o).toLocaleDateString()}editUser(){this.toastTitle="Modificar datos del usuario",this.userSVC.updateUser(this.form.value).pipe((0,g.P)()).subscribe({next:o=>{this.showToast=!0,this.bgColor="success",this.toastContent=o.Message,setTimeout(()=>{this.showToast=!1},7e3)},error:o=>{this.toastContent=o.message,this.showToast=!0,this.bgColor="danger",this.showToastBorrarUsuario=!1,setTimeout(()=>{this.showToast=!1},7e3)}})}deleteUser(){const o=this.form.controls.userId.value;o&&(this.toastTitle="Borrar usuario",this.userSVC.deleteUser(o).pipe((0,g.P)()).subscribe({next:r=>{this.toastContent=r.Message,this.showToastBorrarUsuario=!1,this.showToast=!0,this.bgColor="success",setTimeout(()=>{this.showToast=!1},7e3)},error:r=>{this.toastContent=r.message,this.showToastBorrarUsuario=!1,this.showToast=!0,this.bgColor="danger",setTimeout(()=>{this.showToast=!1},7e3)}}))}confirmarUser(o){this.form.setValue({name:o.name,email:o.email,userId:o.userId,username:o.username,role:"admin"==o.role?"Administrador":"Fabrica"})}closeToast(){this.resetStatus()}disableInputs(){this.form.get("email")?.disable(),this.form.get("username")?.disable()}resetStatus(){this.showToast=!1,this.isButtonLoginDisabled=!0,this.showToastBorrarUsuario=!1}ngOnDestroy(){this._userSubscription&&this._userSubscription.unsubscribe(),this.resetStatus()}formValid(){this.isButtonLoginDisabled=!!this.form.invalid}createForm(){this.form=this.formBuilder.group({userId:["",i.kI.required],name:["",i.kI.required],username:["",[i.kI.required,i.kI.minLength(3)]],email:["",i.kI.required],role:["",i.kI.required]})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(_.K),e.Y36(i.qu),e.Y36(d.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-users"]],decls:91,vars:20,consts:[[1,"position"],["placement","top-end","position","absolute"],[3,"autohide","visible"],[3,"cBgColor"],[1,"me-auto","text-info"],["backdrop","static","id","staticBackdropModal"],["staticBackdropModal",""],["cBgColor","info"],["cModalTitle","",1,"text-info"],["cButtonClose","",3,"cModalToggle"],[1,"justify-content-md-start"],["cButton","","color","danger",3,"cModalToggle","click"],[1,"text-info"],["cButton","","color","secondary",1,"m-2",3,"cModalToggle"],["backdrop","static","id","editUserModal"],["editUserModal",""],["cBgColor","dark"],[1,"justify-content-center"],["lg","7","md","9","xl","12"],[1,"p-4"],["cForm","",3,"formGroup"],[1,"mb-4"],["cInputGroupText",""],["type","text","cFormControl","","formControlName","name",3,"ngModelChange"],[1,"mb-3"],["cFormControl","","formControlName","username"],["cFormControl","","formControlName","email"],["ng","",1,"mb-3"],["cInputGroupText","","for","roles"],["id","roles","cSelect","","cFormControl","","formControlName","role",3,"ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["cButton","","color","success",3,"cModalToggle","disabled","click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["xs",""],[1,"d-grid","gap-2","d-md-flex","justify-content-md-end"],["cButton","","color","dark","cTooltip","A\xf1adir nuevo usuario","cTooltipPlacement","top",1,"me-md-2","d-grid","gap-2","d-md-flex","justify-content-md-end"],["cNavLink","","routerLink","/register","cTooltip","A\xf1adir nuevo usuario","cTooltipPlacement","top"],["cTextColor","white","width","22","title","Shield Icon",3,"cIcon"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],["cTableColor","light"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"small","text-medium-emphasis"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-center"],["cButton","","color","dark","cTooltipPlacement","top","cTooltip","Ver o editar datos del usuario",1,"me-md-2",3,"cModalToggle","click"],["cTextColor","white",3,"cIcon"],["cButton","","color","danger","cTooltipPlacement","top","cTooltip","Borrar usuario",1,"me-md-2",3,"disabled","cModalToggle","click"]],template:function(o,r){if(1&o&&(e.TgZ(0,"div",0)(1,"c-toaster",1)(2,"c-toast",2)(3,"c-toast-header",3),e._UZ(4,"toast-sample-icon"),e.TgZ(5,"strong",4),e._uU(6),e.qZA()(),e.TgZ(7,"c-toast-body"),e._uU(8),e.qZA()()()(),e.TgZ(9,"c-modal",5,6)(11,"c-modal-header",7)(12,"h5",8),e._uU(13,"Confirmar borrar usuario"),e.qZA(),e._UZ(14,"button",9),e.qZA(),e.TgZ(15,"c-modal-body"),e._uU(16," Esta acci\xf3n es irreversible. \xbfEst\xe1s seguro que quieres borrar este usuario de tu sistema? "),e.qZA(),e.TgZ(17,"c-modal-footer",10)(18,"button",11),e.NdJ("click",function(){return r.deleteUser()}),e.TgZ(19,"span",12)(20,"strong"),e._uU(21,"Borrar"),e.qZA()()(),e.TgZ(22,"button",13)(23,"span",12)(24,"strong"),e._uU(25,"Cancelar"),e.qZA()()()()(),e.TgZ(26,"c-modal",14,15)(28,"c-modal-header",16)(29,"h5",8),e._uU(30,"Editar Usuario"),e.qZA(),e._UZ(31,"button",9),e.qZA(),e.TgZ(32,"c-modal-body")(33,"c-row",17)(34,"c-col",18)(35,"c-card")(36,"c-card-body",19)(37,"form",20)(38,"c-input-group",21)(39,"label",22),e._uU(40,"Nombre"),e.qZA(),e.TgZ(41,"input",23),e.NdJ("ngModelChange",function(){return r.formValid()}),e.qZA()(),e.TgZ(42,"c-input-group",24)(43,"label",22),e._uU(44," Usuario"),e.qZA(),e._UZ(45,"input",25),e.qZA(),e.TgZ(46,"c-input-group",24)(47,"label",22),e._uU(48,"Email"),e.qZA(),e._UZ(49,"input",26),e.qZA(),e.TgZ(50,"c-input-group",27)(51,"label",28),e._uU(52,"Rol"),e.qZA(),e.TgZ(53,"select",29),e.NdJ("ngModelChange",function(){return r.formValid()}),e.YNc(54,A,2,2,"option",30),e.qZA()()()()()()()(),e.TgZ(55,"c-modal-footer",10)(56,"button",31),e.NdJ("click",function(){return r.editUser()}),e.YNc(57,v,1,0,"span",32),e.TgZ(58,"span",12)(59,"strong"),e._uU(60,"Guardar cambios"),e.qZA()()(),e.TgZ(61,"button",13)(62,"span",12)(63,"strong"),e._uU(64,"Cancelar"),e.qZA()()()()(),e.TgZ(65,"c-row")(66,"c-col",33)(67,"c-card",21)(68,"c-card-header")(69,"div",34)(70,"button",35)(71,"a",36),e.O4$(),e._UZ(72,"svg",37),e.qZA()()()(),e.kcU(),e.TgZ(73,"c-card-body")(74,"table",38)(75,"thead",39)(76,"tr")(77,"th"),e._uU(78,"Nombre y Apellidos"),e.qZA(),e.TgZ(79,"th"),e._uU(80,"Usuario"),e.qZA(),e.TgZ(81,"th"),e._uU(82,"Rol"),e.qZA(),e.TgZ(83,"th"),e._uU(84,"Email"),e.qZA(),e.TgZ(85,"th"),e._uU(86,"Fecha de alta"),e.qZA(),e.TgZ(87,"th",40),e._uU(88,"Acci\xf3n"),e.qZA()()(),e.TgZ(89,"tbody"),e.YNc(90,q,21,10,"tr",41),e.qZA()()()()()()),2&o){const n=e.MAs(10),c=e.MAs(27);e.xp6(2),e.s9C("visible",r.showToast),e.Q6J("autohide",!1),e.xp6(1),e.s9C("cBgColor",r.bgColor),e.xp6(3),e.Oqu(r.toastTitle),e.xp6(2),e.Oqu(r.toastContent),e.xp6(6),e.Q6J("cModalToggle",n.id),e.xp6(4),e.Q6J("cModalToggle",n.id),e.xp6(4),e.Q6J("cModalToggle",n.id),e.xp6(9),e.Q6J("cModalToggle",c.id),e.xp6(6),e.Q6J("formGroup",r.form),e.xp6(17),e.Q6J("ngForOf",r.roles),e.xp6(2),e.Q6J("cModalToggle",c.id)("disabled",r.isButtonLoginDisabled),e.xp6(1),e.Q6J("ngIf",r.loading),e.xp6(4),e.Q6J("cModalToggle",c.id),e.xp6(11),e.Q6J("cIcon",r.icons.cilUserPlus),e.xp6(2),e.Q6J("hover",!0)("responsive",!0)("striped",!0),e.xp6(16),e.Q6J("ngForOf",r.users)}},dependencies:[h.ar,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,u.sg,u.O5,s.qRY,d.rH,i.sg,i.u,s.Vh3,s.AkF,s.yue,s.nkx,s.$_X,s.oHf,s.nqR,s.g8K,s.jOm,s.Yp0,s.iok,s.auY,s.io7,s.KF4,s.zS7,s.YI7,s.Rbl,s.vPP,s.Ntb,s.kzT,s.k_T,s.B1r,s.Hq3,s.PFQ,s.i9q,s.aTG,s.g8e],styles:[".text-info[_ngcontent-%COMP%]{color:#fff!important}"]}),t})(),data:{title:$localize`Todos los usuarios`,allowedRoles:["admin"]}},{path:":userId",component:(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-profile"]],decls:2,vars:0,template:function(o,r){1&o&&(e.TgZ(0,"p"),e._uU(1,"user-profile works!"),e.qZA())}}),t})(),data:{title:$localize`User`,allowedRoles:["admin","fabrica"]}}];let y=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.Bz.forChild(B),d.Bz]}),t})();var I=l(5368);let J=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.QX,i.u5,u.ez,u.ez,s.qRY,y,i.UX,I.t]}),t})()}}]);